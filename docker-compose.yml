version: "3.8"

services:
  database:
    image: mcr.microsoft.com/mssql/server:2019-latest
    user: root
    environment:
      SA_PASSWORD: "BirminghamBank!202#"
      ACCEPT_EULA: "Y"
      MSSQL_PID: "Express"
    ports:
      - "1433:1433"
    volumes:
      - db_data:/var/opt/mssql/data
  banking-api:
    build: .
    environment:
      CONNECTION_STRING: "Server=database;Initial Catalog=banking;User Id=sa;Password=BirminghamBank!202#;Encrypt=False;TrustServerCertificate=True"
      APP_NAME: "Banking API"
      ASPNETCORE_ENVIRONMENT: "Local"
      S3SETTINGS_UPLOADDOCUMENT_BUCKETNAME: "birminghambankdev"
      S3SETTINGS_UPLOADDOCUMENT_ACCESSKEYID: "AKIA6KBW3VEV4CEWM3ME"
      S3SETTINGS_UPLOADDOCUMENT_SECRETACCESSKEY: "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"
      EMAILSERVICE_SENDGRID_API_KEY: "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"
      EMAIL_OPERATIONS_EMAIL: "test-no-reply@birminghambank.com"
      EMAIL_OPERATIONS_EMAIL_URL: "https://dashboard.birminghambank.com/savings/{0}"
      EMAIL_OPERATIONS_SUBJECT: "New Bank Account Application"
      EMAIL_CUSTOMER_SUBJECT: "New Bank Account Application"
      EMAIL_LOGO_PATH: "./Templates/Images/logo-white.png"
      EMAIL_OPERATIONS_SUBJECT_INCONSISTENCY: "Credit Notification Inconsistency"
      LloydsBank__BaseUrl: "https://sandbox.api.commercial.lloydsbanking.com/o/commercial-direct-channel/"
      LloydsBank__ClientId: "f7e1c228-78fc-4a6d-af02-524301dfe926"
      LloydsBank__Kid: "XHigsKiVv_OEZ8ZTe__ZsRhsE54"
      LloydsBank__SubscriptionKey: "624ae35a79d2437cab1207b329070609"
      LloydsBank__CertificatePassword: "StAlbans@4701"
      LloydsBank__TlsPrivateKey: "MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQDGrNf0mrRERjYW7a6/hoZtMCMURPoVYrfllCmNooWEwx2e2UxUkbA/kxu7AP1ChodmDoU94k6apvqumhjKStEitx5tAP7j1QzOiMIRYwoyPaU8CzUYGCTTqSvW/PO4hn6q1JT2XF9ODgro8H+M9S7XqMyGqdIVTMr0LnbeBxKiJ1+gpsn8q/Y9BYou9oFHuY3SoktDkOkOP5jtgmCGHXAImH6goYzd3Oc6/X+aJ8l+GYY1rbRqB9jrq3XyA/O/ZMmdckyyoics9Y2PaQ0BCs0lU/vmgskTMHAgCYNANYQTcJqW9tgq1aaSCXdHPBE58KLeM7lDzbTN8N7Clf23JAR9AgMBAAECggEABDwo+lDV6OKqQoDcib6fXPJ6vPLfddc93knzPM6rE/JozjsJkn/sht5m5+yUeXeOqVFD69bIICnRDCnCv4UqwhevMVmlFUw0Uq69nEtFK17/B7GhdxsEpfJkOdf4hgVv68pORpYfffV0rBR8U4/iaLxzZ6d1D/ksFlprND5oWkZ8+N4Mo9YKizbJ2SsDBupfTdULsP58o/swqMTAXdc3iXCI/Jd176BL4kJLEOFeJB0UtWIoG8GSYTRgwsNQP50Rpn7nMkyNKCcWUaQqQjNHb7aCY+z8/ccv7bYevaW1OGZHWB7GaZwfkDnATLuIHEMggACYPlQyP126waA2Oh2vQQKBgQDjqTBCpj2OMaOm6A+i1XudZAh5SFrniL2HoRdbl4pZ2GU66qTgqNbBCG8QhKQIL/GnP+5gtJiLDLBEYeWClX+Osn8HKMoQ8aDoGjJK4sCIExPh0Gw1zgFE9AM5UsdrGQf9/wt/y6ujdjRyxmnx5XmTz1qnm+KC+bG7guslivMWMQKBgQDfZ/l1lVgp4EH9rEO9qGklWpADFb/gc2W6z+qJUCPI63fnsj1ySMW8LWSX6rzs1J7VKaG7z4PNoxpaN/ZO6MiYRY65ULdihJX65uxgj/1fGB/UvPWbAnLXcgRfl/QT09WxOkG90lR+jh9SHMwammxKaEGo2d2HTb7XIolWMD0kDQKBgQCwgnDEfBels57qvWnCGjrpYLGhNxQkB8TK738oqGnAFyMFdv+2n7FBoMRbzjtPjbySq+KqX9sVlBTmL/C+OiLYBFSwvFNOp8jVq9nqbbxQxFnZ7rq3TK13RKlrPF8ZDiNALwo/Xy4IYpFvm55wyjZk/5ON+DK60dWXSH4AcabfQQKBgAIvYSg+QrN+JwcVJUB4ojakUR5Gmy7V0hvmprObHg58Bxs0ChfREGYLx50YxapHVhpdouBUYkSjoMFbJMSW0Ed0/rVfTbvf8huXIJ69KcxBTyZkhr5yYq8qxVIuCUwcWU23dScnJH5sY3AJKhHkisSbinDdWKZXI1O1WcSHCkINAoGAB9FyvaeMicZkMz3Ey2vZszmFxAccgtQ4CbN8rtEe9HcD1p/N06iaXTt3Z+RPuV0qdklqqocNrr0m/dpq1qo8BFu9Gy+amv49sME9W0TB72+g6yl24t+MzCpxOqPoJcr1XkarYRfSiovsZTyU22IH7ByRMLlmvLEaDxtYbpojqb4="
      LloydsBank__MlsPrivateKey: "-----BEGIN PRIVATE KEY----- MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQDGrNf0mrRERjYW7a6/hoZtMCMURPoVYrfllCmNooWEwx2e2UxUkbA/kxu7AP1ChodmDoU94k6apvqumhjKStEitx5tAP7j1QzOiMIRYwoyPaU8CzUYGCTTqSvW/PO4hn6q1JT2XF9ODgro8H+M9S7XqMyGqdIVTMr0LnbeBxKiJ1+gpsn8q/Y9BYou9oFHuY3SoktDkOkOP5jtgmCGHXAImH6goYzd3Oc6/X+aJ8l+GYY1rbRqB9jrq3XyA/O/ZMmdckyyoics9Y2PaQ0BCs0lU/vmgskTMHAgCYNANYQTcJqW9tgq1aaSCXdHPBE58KLeM7lDzbTN8N7Clf23JAR9AgMBAAECggEABDwo+lDV6OKqQoDcib6fXPJ6vPLfddc93knzPM6rE/JozjsJkn/sht5m5+yUeXeOqVFD69bIICnRDCnCv4UqwhevMVmlFUw0Uq69nEtFK17/B7GhdxsEpfJkOdf4hgVv68pORpYfffV0rBR8U4/iaLxzZ6d1D/ksFlprND5oWkZ8+N4Mo9YKizbJ2SsDBupfTdULsP58o/swqMTAXdc3iXCI/Jd176BL4kJLEOFeJB0UtWIoG8GSYTRgwsNQP50Rpn7nMkyNKCcWUaQqQjNHb7aCY+z8/ccv7bYevaW1OGZHWB7GaZwfkDnATLuIHEMggACYPlQyP126waA2Oh2vQQKBgQDjqTBCpj2OMaOm6A+i1XudZAh5SFrniL2HoRdbl4pZ2GU66qTgqNbBCG8QhKQIL/GnP+5gtJiLDLBEYeWClX+Osn8HKMoQ8aDoGjJK4sCIExPh0Gw1zgFE9AM5UsdrGQf9/wt/y6ujdjRyxmnx5XmTz1qnm+KC+bG7guslivMWMQKBgQDfZ/l1lVgp4EH9rEO9qGklWpADFb/gc2W6z+qJUCPI63fnsj1ySMW8LWSX6rzs1J7VKaG7z4PNoxpaN/ZO6MiYRY65ULdihJX65uxgj/1fGB/UvPWbAnLXcgRfl/QT09WxOkG90lR+jh9SHMwammxKaEGo2d2HTb7XIolWMD0kDQKBgQCwgnDEfBels57qvWnCGjrpYLGhNxQkB8TK738oqGnAFyMFdv+2n7FBoMRbzjtPjbySq+KqX9sVlBTmL/C+OiLYBFSwvFNOp8jVq9nqbbxQxFnZ7rq3TK13RKlrPF8ZDiNALwo/Xy4IYpFvm55wyjZk/5ON+DK60dWXSH4AcabfQQKBgAIvYSg+QrN+JwcVJUB4ojakUR5Gmy7V0hvmprObHg58Bxs0ChfREGYLx50YxapHVhpdouBUYkSjoMFbJMSW0Ed0/rVfTbvf8huXIJ69KcxBTyZkhr5yYq8qxVIuCUwcWU23dScnJH5sY3AJKhHkisSbinDdWKZXI1O1WcSHCkINAoGAB9FyvaeMicZkMz3Ey2vZszmFxAccgtQ4CbN8rtEe9HcD1p/N06iaXTt3Z+RPuV0qdklqqocNrr0m/dpq1qo8BFu9Gy+amv49sME9W0TB72+g6yl24t+MzCpxOqPoJcr1XkarYRfSiovsZTyU22IH7ByRMLlmvLEaDxtYbpojqb4= -----END PRIVATE KEY-----"
      LloydsBank__TlsCertificate: "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"
      EmailSettings__Password: "lu$$hMagic95"
      SQS_EDN_QUEUE_URL: "http://localstack:4566/000000000000/edn-test-queue"
      SQS_COP_QUEUE_URL: "http://localstack:4566/000000000000/cop-test-queue"
      S3_LOCALSTACK_SERVICE_URL: "http://localstack:4566"
    depends_on:
      - database
      - localstack
    ports:
      - "8080:80"
  localstack:
    image: localstack/localstack
    environment:
      - SERVICES=s3,sqs
      - SQS_ENDPOINT_STRATEGY=off
    ports:
      - "4566:4566"
    volumes:
      - ./init.sh:/etc/localstack/init/ready.d/init.sh

volumes:
  db_data:
